---
layout: wiki #使用wiki公共模版
wiki: tools #项目名
title: ssh端口转发
categories: [小工具]
date: 2023-11-02 16:06:08
tags: [ssh,端口转发]
description: ssh端口转发
---

## 前言

{%note color:blue 本文主要介绍如何使用`ssh`端口转发，实现本地端口映射到远程服务器的某个端口，实现远程服务器端口映射到本地的某个端口。(可搭配`autossh`工具实现长时间的内网穿透)%}

## 端口转发

### 本地端口转发
本地端口转发是指将本地的某个端口映射到远程服务器的某个端口，实现本地端口映射到远程服务器的某个端口，实现远程服务器端口映射到本地的某个端口。
```bash
ssh -L 8080:127.0.0.1:8080 root@192.168.1.1
```
解释：

```bash
-L ：#本地端口转发
8080：#本地端口
127.0.0.1：#远程服务器的IP地址
8080：#远程服务器的端口
root@192.168.1.1：#远程服务器的用户名和IP地址
```
### 远程服务器端口转发实现内网穿透
内网穿透是指将本地的某个端口映射到远程服务器的某个端口，实现本地端口映射到远程服务器的某个端口，实现远程服务器端口映射到本地的某个端口，将内网主机的服务映射到有独立IP的公网服务器上。
```bash
ssh -R 8080:127.0.0.1:8080 root@192.1
```
解释：
```bash
-R ：#远程服务器端口转发
8080：#远程服务器的端口
127.0.0.1：#本地的IP地址
8080：#本地的端口
root@192.168.1.1：#远程服务器的用户名和IP地址
```
### 端口映射

端口映射是指将本地某个端口映射到远程服务器的某个端口，实现本地端口映射到远程服务器的某个端口，实现远程服务器端口映射到本地的某个端口。
```bash
ssh -D 8080 root@192.168.1.1
```
解释：
```bash
-D ：端口映射
8080：本地的端口
root@192.168.1.1：远程服务器的用户名和IP地址
```
## 端口转发的应用场景

端口转发的应用场景：
- 实现本地端口映射到远程服务器的某个端口
- 实现远程服务器端口映射到本地的某个端口

## ssh参数说明
| 参数 | 说明 |
| --- | --- |
| -L | 本地端口转发 |
| -R | 远程服务器端口转发 |
| -D | 端口映射 |
| -f | 后台运行 |
| -N | 不执行远程命令 |
| -T | 不执行远程命令 |
| -C | 压缩数据 |
| -o | 远程服务器配置 |
| -p | 远程服务器端口 |
| -l | 远程服务器用户名 |
| -i | 私钥文件 |
| -v | 详细输出 |
| -q | 安静模式 |
| -4 | IPv4 |
| -6 | IPv6 |
| -C | 压缩数据 |
| -o | 远程服务器配置 |

## 端口转发的优点
- 实现本地端口映射到远程服务器的某个端口
- 实现远程服务器端口映射到本地的某个端口

## 总结

端口转发是指将本地的某个端口映射到远程服务器的某个端口，实现本地端口映射到远程服务器的某个端口，实现远程服务器端口映射到本地的某个端口。


## 参考
- [ssh端口转发](https://www.ruanyifeng.com/blog/2011/12/ssh_port_forwarding.html)
